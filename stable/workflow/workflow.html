
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DoubleML Workflow &#8212; DoubleML  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=c49bcd98" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=1ecd1175"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'workflow/workflow';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.doubleml.org/dev/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'stable';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User Guide" href="../guide/guide.html" />
    <link rel="prev" title="Getting Started" href="../intro/intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">Interested to learn more? We offer <a href='https://trainings.doubleml.org/'>DoubleML Trainings!</a></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/logo_dark.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">DoubleML</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro/install.html">
     Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro/intro.html">
     Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
     Workflow
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/guide.html">
     User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
     Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/api.html">
     Python API
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://docs.doubleml.org/r/stable/">
     R API
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://docs.doubleml.org/doubleml-coverage/">
     Coverage Repository
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../literature/literature.html">
     Literature
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../release/release.html">
     Release notes
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/DoubleML/doubleml-for-py" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/DoubleML/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-cube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro/install.html">
     Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro/intro.html">
     Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
     Workflow
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/guide.html">
     User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
     Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/api.html">
     Python API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://docs.doubleml.org/r/stable/">
     R API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://docs.doubleml.org/doubleml-coverage/">
     Coverage Repository
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../literature/literature.html">
     Literature
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../release/release.html">
     Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/DoubleML/doubleml-for-py" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/DoubleML/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-cube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">DoubleML Workflow</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="doubleml-workflow">
<span id="workflow"></span><h1>DoubleML Workflow<a class="headerlink" href="#doubleml-workflow" title="Link to this heading">#</a></h1>
<p>The following steps, which we call the DoubleML workflow, are intended to provide a rough structure for causal analyses
with <a class="reference internal" href="../index.html#doubleml-package"><span class="std std-ref">DoubleML</span></a>. After a short explanation of the idea of each step, we illustrate their meaning in the 401(k)
example. In case you are interested in more details of the 401(k) example, you can visit the
<a class="reference external" href="https://docs.doubleml.org/stable/examples/py_double_ml_pension.html">Python</a> and <a class="reference external" href="https://docs.doubleml.org/stable/examples/R_double_ml_pension.html">R</a>
Notebooks that are available online.</p>
<section id="problem-formulation">
<h2>0. Problem Formulation<a class="headerlink" href="#problem-formulation" title="Link to this heading">#</a></h2>
<p>The initial step of the DoubleML workflow is to formulate the causal problem at hand. Before we start our statistical
analysis, we have to explicitly state the conditions required for a causal interpretation of the estimator, which will
be computed later. In many cases, directed acyclical graphs (DAGs) are helpful to formulate the causal problem,
illustrate the involved causal channels and the critical parts of the inferential framework. At this stage, a precise
argumentation and discussion of the research question is crucial.</p>
<a class="reference internal image-reference" href="../_images/causal_graph.svg"><img alt="DAG for the 401(k) Example" class="align-center" src="../_images/causal_graph.svg" style="width: 800px;" />
</a>
<p>In the 401(k) study, we are interested in estimating the average treatment effect of participation in so-called 401(k) pension
plans on employees’ net financial assets. Because we cannot rely on a properly conducted randomized control study in this
example, we have to base our analysis on observational data. Hence, we have to use an identification strategy that is based
on appropriately controlling for potential confounders.
A complication that arises in the 401(k) example is due to so-called endogeneity of the treatment assignment. The treatment
variable is an employee’s participation in a 401(k) pension plan which is a decision made by employees and likely
to be affected by unobservable effects. For example, is seems reasonable that persons with higher income have stronger
preferences to save and also to participate in a pension plan. If our analysis does not account for this self-selection into
treatment, the estimated effect is likely to be biased.</p>
<p>To circumvent the endogenous treatment problem, it is possible to exploit randomness in eligibility for 401(k) plans.
In other words, the access to the treatment can be considered as randomly assigned once we control for confounding variables.
Earlier studies in this context argue that if characteristics that are related to saving preferences are taken into account,
eligibility can be considered as good as randomly assigned (at the time 401(k) plans were introduced).
The conditional exogeneity in the access to treatment makes it possible to estimate the causal effect of interest by using
an instrumental variable (IV) approach. However, for the sake of brevity, we will focus on the so-called intent-to-treat effect in the following.
This effect corresponds to the average treatment effect of eligibility (= the instrument) on net financial assets (= the outcome) and
is of great interest in many applications. The IV analysis is available in the <a class="reference external" href="https://docs.doubleml.org/stable/examples/py_double_ml_pension.html">Python</a>
and <a class="reference external" href="https://docs.doubleml.org/stable/examples/R_double_ml_pension.html">R</a> Notebooks that are available online.</p>
<p>The previous discussion focuses on the causal problem. Let’s also talk about the statistical methods used for estimation.
For identification of the average treatment effect of participation or eligibility on assets, it is crucial that we appropriately
account for the confounding factors. That’s where the machine learning tools come into play. Of course, we could simply estimate
the causal effect by using a classical linear (IV) regression model: The researcher has to manually pick and, perhaps,
transform the confounding variables in the regression model.
However, machine learning techniques offer greater flexibility in terms of a more data-driven specification
of the main regression equation and the first stage.</p>
</section>
<section id="data-backend">
<h2>1. Data-Backend<a class="headerlink" href="#data-backend" title="Link to this heading">#</a></h2>
<p>In Step 1., we initialize the data-backend and thereby declare the role of the outcome, the treatment, and the confounding variables.</p>
<p>We use data from the 1991 Survey of Income and Program Participation which is available via the function
<a class="reference external" href="https://docs.doubleml.org/stable/api/generated/doubleml.datasets.fetch_401K.html">fetch_401K (Python)</a>
or <a class="reference external" href="https://docs.doubleml.org/r/stable/reference/fetch_401k.html">fetch_401k (R)</a>.
The data-backend can be initialized from various data frame objects in Python and R. To estimate the intent-to-treat effect in the
401(k) example, we use eligibility (<code class="docutils literal notranslate"><span class="pre">e401</span></code>) as the treatment variable of interest. The outcome variable is <code class="docutils literal notranslate"><span class="pre">net_tfa</span></code> and we
control for confounding variables <code class="docutils literal notranslate"><span class="pre">['age',</span> <span class="pre">'inc',</span> <span class="pre">'educ',</span> <span class="pre">'fsize',</span> <span class="pre">'marr',</span> <span class="pre">'twoearn',</span> <span class="pre">'db',</span> <span class="pre">'pira',</span> <span class="pre">'hown']</span></code>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="py" for="sd-tab-item-0">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">doubleml</span><span class="w"> </span><span class="kn">import</span> <span class="n">DoubleMLData</span>

<span class="gp">In [2]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">doubleml.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch_401K</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">fetch_401K</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;DataFrame&#39;</span><span class="p">)</span>

<span class="go"># Construct DoubleMLData object</span>
<span class="gp">In [4]: </span><span class="n">dml_data</span> <span class="o">=</span> <span class="n">DoubleMLData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">y_col</span><span class="o">=</span><span class="s1">&#39;net_tfa&#39;</span><span class="p">,</span> <span class="n">d_cols</span><span class="o">=</span><span class="s1">&#39;e401&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>                        <span class="n">x_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;educ&#39;</span><span class="p">,</span> <span class="s1">&#39;fsize&#39;</span><span class="p">,</span> <span class="s1">&#39;marr&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>                                <span class="s1">&#39;twoearn&#39;</span><span class="p">,</span> <span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="s1">&#39;pira&#39;</span><span class="p">,</span> <span class="s1">&#39;hown&#39;</span><span class="p">])</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="r" for="sd-tab-item-1">
R</label><div class="sd-tab-content docutils">
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">DoubleML</span><span class="p">)</span>
<span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fetch_401k</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s">&#39;data.table&#39;</span><span class="p">)</span>
<span class="c1"># Construct DoubleMLData object from data.table</span>
<span class="n">dml_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoubleMLData</span><span class="o">$</span><span class="nf">new</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">y_col</span><span class="o">=</span><span class="s">&#39;net_tfa&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">d_cols</span><span class="o">=</span><span class="s">&#39;e401&#39;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">x_cols</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;age&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;inc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;educ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;fsize&#39;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&#39;marr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;twoearn&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;db&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;pira&#39;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&#39;hown&#39;</span><span class="p">))</span>

<span class="n">data_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fetch_401k</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s">&#39;data.frame&#39;</span><span class="p">)</span>
<span class="c1"># Construct DoubleMLData object from data.frame</span>
<span class="n">dml_data_df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">double_ml_data_from_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">y_col</span><span class="o">=</span><span class="s">&#39;net_tfa&#39;</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">d_cols</span><span class="o">=</span><span class="s">&#39;e401&#39;</span><span class="p">,</span>
<span class="w">                                            </span><span class="n">x_cols</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;age&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;inc&#39;</span><span class="p">,</span>
<span class="w">                                                    </span><span class="s">&#39;educ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;fsize&#39;</span><span class="p">,</span>
<span class="w">                                                    </span><span class="s">&#39;marr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;twoearn&#39;</span><span class="p">,</span>
<span class="w">                                                    </span><span class="s">&#39;db&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;pira&#39;</span><span class="p">,</span>
<span class="w">                                                    </span><span class="s">&#39;hown&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
</div>
</section>
<section id="causal-model">
<h2>2. Causal Model<a class="headerlink" href="#causal-model" title="Link to this heading">#</a></h2>
<p>In Step 2. we choose a causal model. There are several models currently implemented in <a class="reference internal" href="../index.html#doubleml-package"><span class="std std-ref">DoubleML</span></a> which
differ in terms of the underlying causal structure (e.g., including IV variables or not) and the underlying assumptions.</p>
<a class="reference internal image-reference" href="../_images/doubleml_models.svg"><img alt="DoubleML Models" class="align-center" src="../_images/doubleml_models.svg" style="width: 800px;" />
</a>
<p>According to the previous discussion, we are interested in estimation of the effect of eligibility on net financial assets.
Hence, we do not need to use a model with both a treatment and instrumental variable. There are two potential models,
the <a class="reference internal" href="../guide/models.html#plr-model"><span class="std std-ref">partially linear regression model (PLR)</span></a> and the <a class="reference internal" href="../guide/models.html#irm-model"><span class="std std-ref">interactive regression model (IRM)</span></a>. These models differ
in terms of the type of the treatment variable (continuous vs. binary treatment) and the assumptions underlying the regression
equation. For example, the PLR assumes a partially linear structure, whereas the IRM allows treatment effects to be heterogeneous across
individuals. To keep the presentation short, we will choose a partially linear model.</p>
</section>
<section id="ml-methods">
<h2>3. ML Methods<a class="headerlink" href="#ml-methods" title="Link to this heading">#</a></h2>
<p>In Step 3., we can specify the machine learning tools used for estimation of the nuisance parts.
We can generally choose any learner from <a class="reference external" href="https://scikit-learn.org">scikit learn</a> in Python and from the <a class="reference external" href="https://mlr3.mlr-org.com">mlr3</a> ecosystem in R.</p>
<p>There are two nuisance parts in the PLR, <span class="math notranslate nohighlight">\(g_0(X)=\mathbb{E}(Y|X)\)</span> and  <span class="math notranslate nohighlight">\(m_0(X)=\mathbb{E}(D|X)\)</span>.
In this example, let us specify a random forest and an xgboost learner for both prediction problems.
We can directly pass the parameters during initialization of the learner objects.
Because we have a binary treatment variable, we can use a classification learner for the corresponding nuisance part.
We use a regression learner for the continuous outcome variable net financial assets.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="py" for="sd-tab-item-2">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Random forest learners</span>
<span class="gp">In [5]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">RandomForestRegressor</span>

<span class="gp">In [6]: </span><span class="n">ml_l_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
<span class="gp">   ...: </span>                                <span class="n">max_features</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [7]: </span><span class="n">ml_m_rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">   ...: </span>                                <span class="n">max_features</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="go"># Xgboost learners</span>
<span class="gp">In [8]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">XGBClassifier</span><span class="p">,</span> <span class="n">XGBRegressor</span>

<span class="gp">In [9]: </span><span class="n">ml_l_xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">objective</span> <span class="o">=</span> <span class="s2">&quot;reg:squarederror&quot;</span><span class="p">,</span> <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="gp">   ...: </span>                        <span class="n">n_estimators</span> <span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [10]: </span><span class="n">ml_m_xgb</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">use_label_encoder</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">,</span>
<span class="gp">   ....: </span>                        <span class="n">objective</span> <span class="o">=</span> <span class="s2">&quot;binary:logistic&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                        <span class="n">eval_metric</span> <span class="o">=</span> <span class="s2">&quot;logloss&quot;</span><span class="p">,</span>
<span class="gp">   ....: </span>                        <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">34</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="r" for="sd-tab-item-3">
R</label><div class="sd-tab-content docutils">
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">mlr3</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">mlr3learners</span><span class="p">)</span>
<span class="c1"># Random forest learners</span>
<span class="n">ml_l_rf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lrn</span><span class="p">(</span><span class="s">&quot;regr.ranger&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">max.depth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">,</span>
<span class="w">            </span><span class="n">mtry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">min.node.size</span><span class="w"> </span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="n">ml_m_rf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lrn</span><span class="p">(</span><span class="s">&quot;classif.ranger&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">max.depth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span>
<span class="w">            </span><span class="n">mtry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">min.node.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>

<span class="c1"># Xgboost learners</span>
<span class="n">ml_l_xgb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lrn</span><span class="p">(</span><span class="s">&quot;regr.xgboost&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">objective</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;reg:squarederror&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">nrounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">)</span>
<span class="n">ml_m_xgb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lrn</span><span class="p">(</span><span class="s">&quot;classif.xgboost&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">objective</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;binary:logistic&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">eval_metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;logloss&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">nrounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">34</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
</div>
</section>
<section id="dml-specifications">
<h2>4. DML Specifications<a class="headerlink" href="#dml-specifications" title="Link to this heading">#</a></h2>
<p>In Step 4., we initialize and parametrize the model object which will later be used to perform the estimation.</p>
<p>We initialize a <a class="reference external" href="https://docs.doubleml.org/stable/api/generated/doubleml.DoubleMLPLR.html">DoubleMLPLR (Python)</a> /
<a class="reference external" href="https://docs.doubleml.org/r/stable/reference/DoubleMLPLR.html">DoubleMLPLR (R)</a>
object using the previously generated data-backend. Moreover, we specify the resampling
(= the number of repetitions and folds for <a class="reference internal" href="../guide/resampling.html#repeated-cross-fitting"><span class="std std-ref">repeated cross-fitting</span></a>),
the dml algorithm (<a class="reference internal" href="../guide/algorithms.html#algorithms"><span class="std std-ref">DML1 vs. DML2</span></a>) and the score function (<a class="reference internal" href="../guide/scores.html#plr-score"><span class="std std-ref">“partialling out” or
“IV-type”</span></a>).</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="py" for="sd-tab-item-4">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">doubleml</span><span class="w"> </span><span class="kn">import</span> <span class="n">DoubleMLPLR</span>

<span class="gp">In [12]: </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="go"># Default values</span>
<span class="gp">In [13]: </span><span class="n">dml_plr_tree</span> <span class="o">=</span> <span class="n">DoubleMLPLR</span><span class="p">(</span><span class="n">dml_data</span><span class="p">,</span>
<span class="gp">   ....: </span>                            <span class="n">ml_l</span> <span class="o">=</span> <span class="n">ml_l_rf</span><span class="p">,</span>
<span class="gp">   ....: </span>                            <span class="n">ml_m</span> <span class="o">=</span> <span class="n">ml_m_rf</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [14]: </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="go"># Parametrized by user</span>
<span class="gp">In [15]: </span><span class="n">dml_plr_tree</span> <span class="o">=</span> <span class="n">DoubleMLPLR</span><span class="p">(</span><span class="n">dml_data</span><span class="p">,</span>
<span class="gp">   ....: </span>                            <span class="n">ml_l</span> <span class="o">=</span> <span class="n">ml_l_rf</span><span class="p">,</span>
<span class="gp">   ....: </span>                            <span class="n">ml_m</span> <span class="o">=</span> <span class="n">ml_m_rf</span><span class="p">,</span>
<span class="gp">   ....: </span>                            <span class="n">n_folds</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">   ....: </span>                            <span class="n">n_rep</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">   ....: </span>                            <span class="n">score</span> <span class="o">=</span> <span class="s1">&#39;partialling out&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="r" for="sd-tab-item-5">
R</label><div class="sd-tab-content docutils">
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="c1"># Default values</span>
<span class="n">dml_plr_forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoubleMLPLR</span><span class="o">$</span><span class="nf">new</span><span class="p">(</span><span class="n">dml_data</span><span class="p">,</span>
<span class="w">                                </span><span class="n">ml_l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml_l_rf</span><span class="p">,</span>
<span class="w">                                </span><span class="n">ml_m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml_m_rf</span><span class="p">)</span>

<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="c1"># Parametrized by user</span>
<span class="n">dml_plr_forest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoubleMLPLR</span><span class="o">$</span><span class="nf">new</span><span class="p">(</span><span class="n">dml_data</span><span class="p">,</span>
<span class="w">                                </span><span class="n">ml_l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml_l_rf</span><span class="p">,</span>
<span class="w">                                </span><span class="n">ml_m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ml_m_rf</span><span class="p">,</span>
<span class="w">                                </span><span class="n">n_folds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">                                </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;partialling out&#39;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">dml_procedure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;dml2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
</div>
</section>
<section id="estimation">
<h2>5. Estimation<a class="headerlink" href="#estimation" title="Link to this heading">#</a></h2>
<p>We perform estimation in Step 5. In this step, the cross-fitting algorithm is executed such that the predictions
in the score are computed. As an output, users can access the coefficient estimates and standard errors either via the
corresponding fields or via a summary.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="py" for="sd-tab-item-6">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Estimation</span>
<span class="gp">In [16]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gh">Out[16]: </span><span class="go">&lt;doubleml.plm.plr.DoubleMLPLR at 0x7f27f1c6ae40&gt;</span>

<span class="go"># Coefficient estimate</span>
<span class="gp">In [17]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">coef</span>
<span class="gh">Out[17]: </span><span class="go">array([8909.63407762])</span>

<span class="go"># Standard error</span>
<span class="gp">In [18]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">se</span>
<span class="gh">Out[18]: </span><span class="go">array([1321.82228913])</span>

<span class="go"># Summary</span>
<span class="gp">In [19]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">summary</span>
<span class="gh">Out[19]: </span>
<span class="go">             coef      std err  ...        2.5 %        97.5 %</span>
<span class="go">e401  8909.634078  1321.822289  ...  6318.909997  11500.358158</span>

<span class="go">[1 rows x 6 columns]</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="r" for="sd-tab-item-7">
R</label><div class="sd-tab-content docutils">
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimation</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="nf">fit</span><span class="p">()</span>

<span class="c1"># Coefficient estimate</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="n">coef</span>

<span class="c1"># Standard error</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="n">se</span>

<span class="c1"># Summary</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="nf">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>INFO  [18:32:39.712] [mlr3] Applying learner &#39;regr.ranger&#39; on task &#39;nuis_l&#39; (iter 1/3)
INFO  [18:32:41.593] [mlr3] Applying learner &#39;regr.ranger&#39; on task &#39;nuis_l&#39; (iter 2/3)
INFO  [18:32:42.811] [mlr3] Applying learner &#39;regr.ranger&#39; on task &#39;nuis_l&#39; (iter 3/3)
INFO  [18:32:44.111] [mlr3] Applying learner &#39;classif.ranger&#39; on task &#39;nuis_m&#39; (iter 1/3)
INFO  [18:32:45.111] [mlr3] Applying learner &#39;classif.ranger&#39; on task &#39;nuis_m&#39; (iter 2/3)
INFO  [18:32:46.138] [mlr3] Applying learner &#39;classif.ranger&#39; on task &#39;nuis_m&#39; (iter 3/3)
</pre></div>
</div>
<div class="output text_html"><strong>e401:</strong> 9126.99864670889</div><div class="output text_html"><strong>e401:</strong> 1312.93958082416</div><div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Estimates and significance testing of the effect of target variables
     Estimate. Std. Error t value Pr(&gt;|t|)    
e401      9127       1313   6.952 3.61e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


</pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inference">
<h2>6. Inference<a class="headerlink" href="#inference" title="Link to this heading">#</a></h2>
<p>In Step 6., we can perform further inference methods and finally interpret our findings. For example, we can set up confidence intervals
or, in case multiple causal parameters are estimated, adjust the analysis for multiple testing. <a class="reference internal" href="../index.html#doubleml-package"><span class="std std-ref">DoubleML</span></a>
supports various approaches to perform <a class="reference internal" href="../guide/se_confint.html#sim-inf"><span class="std std-ref">valid simultaneous inference</span></a>
which are partly based on a multiplier bootstrap.</p>
<p>To conclude the analysis on the intent-to-treat effect in the 401(k) example, i.e., the average treatment effect of eligibility for 401(k) pension plans
on net financial assets, we find a positive and significant effect: Being eligible for such a pension plan increases the amount of net financial assets by
approximately <span class="math notranslate nohighlight">\($9,000\)</span>. This estimate is much smaller than the unconditional effect of eligibility on net financial assets:
If we did not control for the confounding variables, the average treatment effect would correspond to <span class="math notranslate nohighlight">\($19,559\)</span>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-8" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="py" for="sd-tab-item-8">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Summary</span>
<span class="gp">In [20]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">summary</span>
<span class="gh">Out[20]: </span>
<span class="go">             coef      std err  ...        2.5 %        97.5 %</span>
<span class="go">e401  8909.634078  1321.822289  ...  6318.909997  11500.358158</span>

<span class="go">[1 rows x 6 columns]</span>

<span class="go"># Confidence intervals</span>
<span class="gp">In [21]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">confint</span><span class="p">()</span>
<span class="gh">Out[21]: </span>
<span class="go">            2.5 %        97.5 %</span>
<span class="go">e401  6318.909997  11500.358158</span>

<span class="go"># Multiplier bootstrap (relevant in case with multiple treatment variables)</span>
<span class="gp">In [22]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">()</span>
<span class="gh">Out[22]: </span><span class="go">&lt;doubleml.plm.plr.DoubleMLPLR at 0x7f27f1c6ae40&gt;</span>

<span class="go"># Simultaneous confidence bands</span>
<span class="gp">In [23]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">confint</span><span class="p">(</span><span class="n">joint</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[23]: </span>
<span class="go">            2.5 %        97.5 %</span>
<span class="go">e401  6075.923943  11743.344212</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-9" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="r" for="sd-tab-item-9">
R</label><div class="sd-tab-content docutils">
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Summary</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="nf">summary</span><span class="p">()</span>

<span class="c1"># Confidence intervals</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="nf">confint</span><span class="p">()</span>

<span class="c1"># Multiplier bootstrap (relevant in case with multiple treatment variables)</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="nf">bootstrap</span><span class="p">()</span>

<span class="c1"># Simultaneous confidence bands</span>
<span class="n">dml_plr_forest</span><span class="o">$</span><span class="nf">confint</span><span class="p">(</span><span class="n">joint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Estimates and significance testing of the effect of target variables
     Estimate. Std. Error t value Pr(&gt;|t|)    
e401      9127       1313   6.952 3.61e-12 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 1 × 2 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>
</thead>
<tbody>
	<tr><th scope=row>e401</th><td>6553.684</td><td>11700.31</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table class="dataframe">
<caption>A matrix: 1 × 2 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>
</thead>
<tbody>
	<tr><th scope=row>e401</th><td>6553.428</td><td>11700.57</td></tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</section>
<section id="sensitivity-analysis">
<h2>7. Sensitivity Analysis<a class="headerlink" href="#sensitivity-analysis" title="Link to this heading">#</a></h2>
<p>In Step 7., we can analyze the sensitivity of the estimated parameters. In the <a class="reference internal" href="../guide/models.html#plr-model"><span class="std std-ref">Partially linear regression model (PLR)</span></a> the causal interpretation
relies on conditional exogeneity, which requires to control for confounding variables. The <a class="reference internal" href="../index.html#doubleml-package"><span class="std std-ref">DoubleML</span></a> python package
implements <a class="reference internal" href="../guide/sensitivity.html#sensitivity"><span class="std std-ref">Sensitivity analysis</span></a> with respect to omitted confounders.</p>
<p>Analyzing the sensitivity of the intent-to-treat effect in the 401(k) example, we find that the effect remains positive even after adjusting for
omitted confounders with a lower bound of <span class="math notranslate nohighlight">\($4,611\)</span> for the point estimate and <span class="math notranslate nohighlight">\($2,359\)</span> including statistical uncertainty.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-10" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="py" for="sd-tab-item-10">
Python</label><div class="sd-tab-content docutils">
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Sensitivity analysis</span>
<span class="gp">In [24]: </span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">sensitivity_analysis</span><span class="p">(</span><span class="n">cf_y</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">cf_d</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="gh">Out[24]: </span><span class="go">&lt;doubleml.plm.plr.DoubleMLPLR at 0x7f27f1c6ae40&gt;</span>

<span class="go"># Sensitivity summary</span>
<span class="gp">In [25]: </span><span class="nb">print</span><span class="p">(</span><span class="n">dml_plr_tree</span><span class="o">.</span><span class="n">sensitivity_summary</span><span class="p">)</span>
<span class="go">================== Sensitivity Analysis ==================</span>

<span class="go">------------------ Scenario          ------------------</span>
<span class="go">Significance Level: level=0.95</span>
<span class="go">Sensitivity parameters: cf_y=0.04; cf_d=0.03, rho=1.0</span>

<span class="go">------------------ Bounds with CI    ------------------</span>
<span class="go">      CI lower  theta lower        theta   theta upper      CI upper</span>
<span class="go">0  2359.496777  4610.983759  8909.634078  13208.284397  15430.415812</span>

<span class="go">------------------ Robustness Values ------------------</span>
<span class="go">   H_0    RV (%)   RVa (%)</span>
<span class="go">0  0.0  7.029209  5.233154</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../intro/intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Getting Started</p>
      </div>
    </a>
    <a class="right-next"
       href="../guide/guide.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">User Guide</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-formulation">0. Problem Formulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-backend">1. Data-Backend</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#causal-model">2. Causal Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-methods">3. ML Methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dml-specifications">4. DML Specifications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation">5. Estimation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inference">6. Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-analysis">7. Sensitivity Analysis</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/DoubleML/doubleml-docs/edit/dev/doc/workflow/workflow.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/workflow/workflow.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Bach, P., Chernozhukov, V., Klaassen, S., Kurz, M. S., and Spindler, M..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>